webpackJsonp([31],{"+H5z":function(t,e,a){"use strict";(function(t){var n=a("mvHQ"),i=a.n(n);e.a={name:"hchange",data:function(){return{uploadtarget:"",server:"http://39.107.70.18/Transportation/uploadDriverImage",files:[],navboo:!1,navtext:"分类",navtype:0,changephoto:[],cfileStation:"",wimg:"",mapboo:!1}},mounted:function(){this.$store.state.tfoot=3,this.server=this.service+"/uploadworkImage",this.myajax()},methods:{mapshow:function(t){this.mapboo=!this.mapboo,1==t&&this.upmy()},upmy:function(){if("选择分类"==this.navtext){var e=function(){plus.nativeUI.toast("请选择分类!")};return window.plus?e():document.addEventListener("plusready",e,!1),!1}if(""==this.wimg){var a=function(){plus.nativeUI.toast("请上传图片!")};return window.plus?a():document.addEventListener("plusready",a,!1),!1}var n=this;n.w=plus.nativeUI.showWaiting("上传中...");var o={cuserId:localStorage.getItem("userid"),cfileDealPrevImg1:n.wimg,cfileStation:n.lng+","+n.lat,ctypeTwoId:n.bottomtwoid};console.log(i()(o)),t.ajax({type:"post",url:n.service+"/insertCfileAndCuserAreadyRegister",dataType:"json",data:o,success:function(t){if(console.log(i()(t)),200!=t.status)alert(t.msg);else{var e=function(){plus.nativeUI.closeWaiting(),plus.nativeUI.toast("上传完成"),n.navtext="选择分类"};window.plus?e():document.addEventListener("plusready",e,!1)}},error:function(t){console.log(i()(t))}})},filephotod:function(e){var a=this;plus.nativeUI.actionSheet({title:"请选择",cancel:"取消",buttons:[{title:"删除"}]},function(n){switch(n.index){case 1:t.ajax({type:"post",url:a.service+"/deleteCorkByCfileId",dataType:"json",data:{cfileId:e},success:function(t){if(200==t.status){var e=function(){plus.nativeUI.toast("删除完成！"),a.tab(0)};window.plus?e():document.addEventListener("plusready",e,!1)}else{var n=function(){plus.nativeUI.toast("删除失败!")};window.plus?n():document.addEventListener("plusready",n,!1)}}})}})},opennew:function(t,e){this.$store.state.windexid=e,this.$router.push({name:t})},myajax:function(){plus.nativeUI.showWaiting("加载中");var e=this;t.ajax({type:"get",url:e.service+"/queryListByCuserId",dataType:"json",data:{cuserId:localStorage.getItem("userid"),cfileResult:e.navtype},success:function(t){e.changephoto=t.data,plus.nativeUI.closeWaiting()}})},tab:function(t){this.navtype=t,this.myajax()},navshow:function(t){this.navboo=!this.navboo,this.navtext=t},upload:function(t){var e=this;e.files=[],e.uploadtarget=t;plus.nativeUI.actionSheet({title:"请选择",cancel:"取消",buttons:[{title:"照相机"},{title:"相册"}]},function(t){switch(t.index){case 1:e.camera();break;case 2:e.album()}})},camera:function(){var t=this;plus.camera.getCamera().captureImage(function(e){plus.io.resolveLocalFileSystemURL(e,function(e){e.name;var a=e.toLocalURL();document.getElementById("img"+t.uploadtarget).setAttribute("src",a),t.upload_img(a)},function(t){alert("读取拍照文件错误："+t.message)})},function(t){alert("失败："+t.message)},{filename:"_doc/camera/",index:1})},album:function(){var t=this;plus.gallery.pick(function(e){document.getElementById("img"+t.uploadtarget).setAttribute("src",e),t.upload_img(e)},function(t){alert("取消选择图片")},{filter:"image"})},upload_img:function(e){var a=this,n=new Image;n.src=e,n.onload=function(){var e=this.width,n=this.height,i=e/n;n=(e=800)/i;var o=document.createElement("canvas"),s=o.getContext("2d");t(o).attr({width:e,height:n}),s.drawImage(this,0,0,e,n),a.wimg=o.toDataURL("image/jpeg",1)}}},computed:{tfoot:function(){return this.$store.state.tfoot},service:function(){return this.$store.state.service},bottomtwoid:function(){return this.$store.state.bottomtwoid},lng:function(){return this.$store.state.lng},lat:function(){return this.$store.state.lat}},components:{THead:function(t){return a.e(50).then(function(){var e=[a("AC15")];t.apply(null,e)}.bind(this)).catch(a.oe)},TFoot:function(t){return a.e(54).then(function(){var e=[a("Ki7M")];t.apply(null,e)}.bind(this)).catch(a.oe)},BottomNav:function(t){return a.e(51).then(function(){var e=[a("cBse")];t.apply(null,e)}.bind(this)).catch(a.oe)},mapChange:function(t){return a.e(52).then(function(){var e=[a("0iOk")];t.apply(null,e)}.bind(this)).catch(a.oe)}}}}).call(e,a("7t+N"))},c6iZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("+H5z"),i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hwzhenggai",attrs:{id:"warpper"}},[n("t-head"),t._v(" "),n("div",{attrs:{id:"main"}},[n("div",{staticClass:"nav"},[n("div",{staticClass:"nav-tab",class:0==t.navtype?"active":"",on:{click:function(e){t.tab(0)}}},[t._v("\n\t\t\t\t未整改\n\t\t\t")]),t._v(" "),n("div",{staticClass:"nav-tab",class:2==t.navtype?"active":"",on:{click:function(e){t.tab(2)}}},[t._v("\n\t\t\t\t整改\n\t\t\t")])]),t._v(" "),n("div",{staticClass:"box-group"},[n("div",{staticClass:"box-group"},[t._l(t.changephoto,function(e){return 0!=t.changephoto.length?n("div",{staticClass:"group",on:{click:function(a){t.opennew("changedetail",e.cfileId)}}},[n("div",{staticClass:"riqi"},[n("div",{staticClass:"circle width12"}),t._v(" "),n("span",[t._v(t._s(e.createTime))])]),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(e.cmultipleCommunitiesName)+t._s(e.cgridName))]),t._v(" "),n("img",{attrs:{src:a("SQk+")},on:{click:function(a){a.stopPropagation(),t.filephotod(e.cfileId)}}})]):t._e()}),t._v(" "),0==t.changephoto.length?n("p",[t._v("暂无数据")]):t._e()],2)])]),t._v(" "),n("footer",[n("div",{staticClass:"box-upload workcamera"},[n("div",{staticClass:"upload"},[n("img",{attrs:{src:a("9z6F"),id:"img1"},on:{click:function(e){t.upload("1")}}}),t._v(" "),n("div",{staticClass:"shangchuan"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.navtext,expression:"navtext"}],staticClass:"sck",attrs:{type:"text",placeholder:"请填写标题",readonly:"readonly"},domProps:{value:t.navtext},on:{click:t.navshow,input:function(e){e.target.composing||(t.navtext=e.target.value)}}}),t._v(" "),n("div",{staticClass:"sctext",on:{click:function(e){t.mapshow()}}},[n("span",[t._v("上传")])])])])])]),t._v(" "),n("transition",{attrs:{name:"nav"}},[n("bottom-nav",{directives:[{name:"show",rawName:"v-show",value:t.navboo,expression:"navboo"}],on:{navshow:t.navshow}})],1),t._v(" "),n("t-foot"),t._v(" "),n("transition",{attrs:{name:"bottom"}},[n("map-change",{directives:[{name:"show",rawName:"v-show",value:t.mapboo,expression:"mapboo"}],on:{mapshow:t.mapshow}})],1)],1)},staticRenderFns:[]};var o=function(t){a("gYhR")},s=a("VU/8")(n.a,i,!1,o,null,null);e.default=s.exports},gYhR:function(t,e){}});
//# sourceMappingURL=31.63820c22a3510da52571.js.map